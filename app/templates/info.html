<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>인적정보</title>
  <style>
    body{font-family:system-ui, -apple-system, Segoe UI, Roboto, sans-serif;background:#f6f7fb;margin:0;padding:24px}
    .card{max-width:560px;margin:8vh auto;background:#fff;border-radius:16px;padding:24px;box-shadow:0 8px 24px rgba(0,0,0,.06)}
    label{display:block;margin:12px 0 6px}
    input,select,button{width:100%;padding:12px;border:1px solid #e5e7eb;border-radius:10px}
    button{margin-top:16px;background:#111827;color:#fff;border:none;cursor:pointer}
   .w-compact { width: 90px; } /* 한글 5글자 정도 */
   .unit { align-self:center; padding:0 6px; color:#6b7280; }
   .row-inline{display:flex; gap:8px; align-items:center}
input, select, button { box-sizing: border-box; } /* 패딩 포함 폭 계산 */
.row-inline { 
  display: flex; 
  gap: 8px; 
  align-items: center; 
  flex-wrap: wrap;             /* ← 좁은 화면에서 자동 줄바꿈 */
}
/* 연-월-일 입력 폭을 ‘문자 수’ 기반으로 딱 맞추기 (여유 1ch) */
.in-year { width: 7ch; }  /* YYYY(4) + 여유 */
.in-mm, .in-dd { width: 4.5ch; } /* MM/DD(2) + 여유 */
  </style>
</head>
<body>
  <div class="card">
    <h1>인적정보</h1>
    <form id="infoForm" method="post" action="/info">
      <label>이름</label>
      <input type="text" name="name" placeholder="홍길동" required/>
<label>생년월일</label>
<div class="row-inline">
<input type="text" id="bd_y" class="in-year" inputmode="numeric" placeholder="YYYY" maxlength="4"
       oninput="this.value=this.value.replace(/[^0-9]/g,'').slice(0,4); autoNext(this,'bd_m',4)" />
  <span class="unit">년</span>
<input type="text" id="bd_m" class="in-mm" inputmode="numeric" placeholder="MM" maxlength="2"
       oninput="
         let n=this.value.replace(/[^0-9]/g,'').slice(0,2);
         if(n===''){ this.value=''; autoNext(this,'bd_d',2); return; }
         let num=parseInt(n,10);
         if(num<1){ n='1'; } else if(num>12){ n='12'; }
         this.value=n; 
         if(n.length===2){ autoNext(this,'bd_d',2); }
       " />
  <span class="unit">월</span>
<input type="text" id="bd_d" class="in-dd" inputmode="numeric" placeholder="DD" maxlength="2"
       oninput="
         let n=this.value.replace(/[^0-9]/g,'').slice(0,2);
         if(n===''){ this.value=''; return; }
         let num=parseInt(n,10);
         if(num<1){ n='1'; } else if(num>31){ n='31'; }
         this.value=n;
       " />
  <span class="unit">일</span>
</div>
<input type="hidden" name="birth_date" id="birth_date" />
 <label>성별</label>
<div style="display:flex;gap:12px">
  <label style="display:inline-flex;align-items:center;gap:6px">
    <input type="radio" name="gender" value="남" required/> <span>남</span>
  </label>
  <label style="display:inline-flex;align-items:center;gap:6px">
    <input type="radio" name="gender" value="여" required/> <span>여</span>
  </label>
</div>
<label>신장 / 체중</label>
<div class="row-inline">
<input type="text" name="height_cm" class="w-compact" placeholder="예: 158.5" inputmode="numeric"
        oninput="format1dpAutoDot(this)" onblur="ensure1dp(this)"/>
  <span class="unit">cm</span>
 <input type="text" name="weight_kg" class="w-compact" placeholder="예: 67.5" inputmode="numeric"
        oninput="format2dpAutoDot(this)" onblur="ensure1dp(this)"/>
  <span class="unit">kg</span>
</div>

      <button type="submit">다음</button>
    </form>
  </div>
</body>
</html>

<script>
function norm1dp(el){
  if(!el.value) return;
  let v = String(el.value).replace(',', '.');
  let f = parseFloat(v);
  if (isNaN(f) || f<0) { el.value = ''; return; }
  el.value = (Math.round(f*10)/10).toFixed(1);
}
function autoNext(el,nextId,max){ if(el.value.length>=max){ const n=document.getElementById(nextId); n && n.focus(); } }
function pad2(n){return String(n).padStart(2,'0');}
document.getElementById('infoForm').addEventListener('submit', function(e){
  const y = document.getElementById('bd_y').value;
  const m = document.getElementById('bd_m').value;
  const d = document.getElementById('bd_d').value;
  if(!(y && m && d && y.length===4 && m.length>=1 && d.length>=1)){
    e.preventDefault(); alert('생년월일을 정확히 입력해주세요.'); return;
  }
  const mm = parseInt(m,10), dd = parseInt(d,10);
  if (isNaN(mm) || mm<1 || mm>12) { e.preventDefault(); alert('월은 1~12 범위로 입력해주세요.'); return; }
  if (isNaN(dd) || dd<1 || dd>31) { e.preventDefault(); alert('일은 1~31 범위로 입력해주세요.'); return; }

  const pad2 = (n)=>String(n).padStart(2,'0');
  document.getElementById('birth_date').value = `${y}-${pad2(mm)}-${pad2(dd)}`;
});

/**
 * 높이/몸무게 전용 입력 포맷터
 * - 숫자만 허용
 * - 앞 3자리 뒤에 자동으로 '.' 삽입 (예: "175" → "175.")
 * - 소수 첫째자리까지만 유지 (예: "175.55" → "175.5")
 * - blur 시 소수점 없으면 ".0" 보정
 */
function format1dpAutoDot(el){
  let v = (el.value || "").replace(/[^\d.]/g,'');  // 숫자/점 이외 제거
  v = v.replace(/\.+/g,'.');                       // 점 연속 입력 방지
  // 아직 점이 없으면, 숫자가 3자리 넘는 순간 자동 점 삽입
  if (!v.includes('.')) {
    if (v.length >= 3) v = v.slice(0,3) + '.' + v.slice(3);
  }
  // 점 뒤는 1자리만 유지
  const [a,b=''] = v.split('.');
  el.value = a.replace(/\D/g,'').slice(0,3) + (v.includes('.') ? '.' + b.replace(/\D/g,'').slice(0,1) : '');
}
function format2dpAutoDot(el){
  let v = (el.value || "").replace(/[^\d.]/g,'');  // 숫자/점 이외 제거
  v = v.replace(/\.+/g,'.');                       // 점 연속 입력 방지
  // 아직 점이 없으면, 숫자가 2자리 넘는 순간 자동 점 삽입
  if (!v.includes('.')) {
    if (v.length >= 2) v = v.slice(0,2) + '.' + v.slice(2);
  }
  // 점 뒤는 1자리만 유지
  const [a,b=''] = v.split('.');
  el.value = a.replace(/\D/g,'').slice(0,3) + (v.includes('.') ? '.' + b.replace(/\D/g,'').slice(0,1) : '');
}
function ensure1dp(el){
  if (!el.value) return;
  if (!el.value.includes('.')) el.value = el.value + '.0';
  // "175." 형태면 ".0" 보정
  if (el.value.endsWith('.')) el.value = el.value + '0';
}
</script>
